<html>
    <head>
        <title> Web RTS Front End</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
    </head>
    <body>
        <ul id="nav_bar">
            <li>Account</li>
            <li>Game Lobbies</li>
        </ul>

        <button id="add_lobby"> Add Lobby </button>
        <button id="refresh_lobby"> Refresh </button>

        <ul id="game_room">
        </ul>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script>
            var socket = io();
            var game_rooms = [];

            $('#add_lobby').on('click', function(){
                socket.emit('add lobby');
            });

            $('#refresh_lobby').on('click', function(){
                $('#game_room').empty();
                game_rooms = [];
                socket.emit('refresh');
            });

            $('#game_room').on('click', "button.join_room", function(){
                let game_room = game_rooms[$(this).parent().index()];
                socket.emit('join_room', JSON.stringify(game_room));
                $('#game_room').empty();
                game_rooms = [];
                socket.emit('refresh');
            });

            $('#game_room').on('click', "button.leave_room", function(){
                let game_room = game_rooms[$(this).parent().index()];
                socket.emit('leave_room', JSON.stringify(game_room));
                $('#game_room').empty();
                game_rooms = [];
                socket.emit('refresh');
            })

            socket.on('add room', function(json){
                let game_room = JSON.parse(json);
                game_rooms.push(game_room);
                $('#game_room').append("<li>" + game_room.game_id + "<button class='join_room'> Join Room</button><button class='leave_room'> Leave Room</button></li>");
            });
        </script>
    </body>
</html>
