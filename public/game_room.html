<html>
<head>
    <title> Web RTS Front End </title>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>

    <div id="game_info">
        <p id="name"></p>
        <br>
        <p> Players </p>
        <ul id="players">
        </ul>
        <p> Ready? <input type="checkbox" id="ready_check"></p>
        <button id="leave_room"> Leave Room </button>
        <button id="start_game"> Start Game</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
        var socket = io();
        var game;

        $(document).ready(function(){
            socket.emit('get_game', localStorage.getItem('game_id'));
        });

        $('#leave_room').on('click', function(){
            socket.emit('leave_room', JSON.stringify(game), localStorage.getItem('player_id'));
            window.location.href = "index.html";
        });

        $('#start_game').on('click', function(){
            socket.emit('start_game');
        });

        socket.on('get_game', function(game_json){
            game = JSON.parse(game_json);
            updateGameHTML();
        });

        function updateGameHTML() {
            $('#name').text(game.game_id);
            $('#players').empty();
            for (let i = 0; i < game.players.length; i++) {
                $('#players').append("<li>" + game.players[i].id + "</li>");
            }
        }

    </script>
</body>
</html>
